<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Grouped Bar Chart</title>
  <!-- Load Google Charts library -->
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <!-- Load PapaParse library for parsing CSV -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
  <style>
    /* Add your custom CSS styles here */
    body {
      font-family: Arial, sans-serif;
    }

    #grouped_bar_chart_div {
      width: 800px;
      height: 600px;
      margin: 0 auto;
    }
  </style>
  <script>
    function drawGroupedBarChart() {
      fetch('mountains_data.csv')
        .then(response => response.text())
        .then(csvText => {
          Papa.parse(csvText, {
            header: true,
            complete: function(results) {
              var mountains = [...new Set(results.data.map(item => item.Mountain))];
              var data = new google.visualization.DataTable();
              data.addColumn('string', 'Cause of death');
              mountains.forEach(mountain => {
                data.addColumn('number', mountain);
              });

              var mountainData = {};

              results.data.forEach(row => {
                var mountain = row['Mountain'];
                var causeOfDeath = row['Cause of death'];
                if (!mountainData[causeOfDeath]) {
                  mountainData[causeOfDeath] = {};
                  mountains.forEach(mountain => {
                    mountainData[causeOfDeath][mountain] = 0;
                  });
                }
                mountainData[causeOfDeath][mountain]++;
              });

              var causesOfDeath = Object.keys(mountainData);

              causesOfDeath.forEach(cause => {
                var rowData = [cause];
                mountains.forEach(mountain => {
                  rowData.push(mountainData[cause][mountain] || 0);
                });
                data.addRow(rowData);
              });

              var options = {
                title: 'Number of Deaths by Cause of Death and Mountain',
                width: 800,
                height: 600,
                legend: { position: 'top' },
                bar: { groupWidth: '75%' },
                isStacked: true
              };

              var chart = new google.visualization.ColumnChart(document.getElementById('grouped_bar_chart_div'));
              chart.draw(data, options);
            }
          });
        })
        .catch(error => console.error('Error fetching the CSV file:', error));
    }

    // Load Google Charts library and call the drawGroupedBarChart function
    google.charts.load('current', { packages: ['corechart'] });
    google.charts.setOnLoadCallback(drawGroupedBarChart);
  </script>
</head>
<body>
  <div id="grouped_bar_chart_div" style="display: flex;width: 900px; height: 500px; flex: 50%;"></div>
</body>
</html>
